(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     58635,       1309]
NotebookOptionsPosition[     51855,       1195]
NotebookOutlinePosition[     55463,       1274]
CellTagsIndexPosition[     55420,       1271]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:0420\:0430\:0441\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\:0438\
\:0435 \:0432\:0435\:0440\:0448\:0438\:043d \:043f\:043e \:0441\:043b\:043e\
\:044f\:043c", "Section",
 CellChangeTimes->{{3.813224384887374*^9, 
  3.8132243896959705`*^9}},ExpressionUUID->"8b90b408-fd12-4cee-b966-\
2854310cf496"],

Cell[TextData[{
 "\t\:041f\:0443\:0441\:0442\:044c ",
 Cell[BoxData[
  FormBox[
   RowBox[{"G", "(", 
    RowBox[{"V", ",", "A"}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "aa168a7b-20d4-4272-9687-856f43b3c35f"],
 " \[Dash] \:0430\:0446\:0438\:043a\:043b\:0438\:0447\:0435\:0441\:043a\:0438\
\:0439 \:043e\:0440\:0433\:0440\:0430\:0444, \:0432\:0435\:0440\:0448\:0438\
\:043d\:044b \:043a\:043e\:0442\:043e\:0440\:043e\:0433\:043e \:043d\:0435\
\:043e\:0431\:0445\:043e\:0434\:0438\:043c\:043e \:0440\:0430\:0441\:043f\
\:0440\:0435\:0434\:0435\:043b\:0438\:0442\:044c \:043f\:043e \:0441\:043b\
\:043e\:044f\:043c. \:0412\:0432\:0435\:0434\:0451\:043c \:043f\:0435\:0440\
\:0435\:043c\:0435\:043d\:043d\:044b\:0435 ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    StyleBox["ij",
     FontSlant->"Italic"]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "70085b72-3f7f-4863-a058-3516c0beb5a6"]
}], "Text",
 CellChangeTimes->{{3.813224396578537*^9, 3.8132244674179926`*^9}, {
  3.8132245368220615`*^9, 
  3.8132245518844624`*^9}},ExpressionUUID->"cd235cef-f9c5-4db4-b661-\
ae6e75934ae7"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["x", 
   StyleBox["ij",
    FontSlant->"Italic"]], "=", 
  TagBox[GridBox[{
     {"\[Piecewise]", GridBox[{
        {"1", 
         RowBox[{
          RowBox[{"\:0432\:0435\:0440\:0448\:0438\:043d\:0430", " ", "i"}], 
          "\[Element]", 
          RowBox[{"j", "-", 
           RowBox[{
           "\:043e\:043c\:0443", " ", "\:0441\:043b\:043e\:044e"}]}]}]},
        {"0", 
         RowBox[{"\:0435\:0441\:043b\:0438", " ", "\:043d\:0435\:0442"}]}
       },
       AllowedDimensions->{2, Automatic},
       Editable->True,
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.84]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}},
       Selectable->True]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxItemSize->{
     "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.35]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   "Piecewise",
   DeleteWithContents->True,
   Editable->False,
   SelectWithContents->True,
   Selectable->False,
   StripWrapperBoxes->True]}]], "DisplayFormula",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132245576921744`*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"56703937-6d11-41ec-bd8e-58c8a3e5797a"],

Cell["\t\:041a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e \:0432\
\:0435\:0440\:0448\:0438\:043d \:043d\:0430 \:0441\:043b\:043e\:0435 \:043c\
\:043e\:0436\:043d\:043e \:043f\:043e\:0441\:0447\:0438\:0442\:0430\:0442\
\:044c", "Text",
 CellChangeTimes->{{3.8132245674914184`*^9, 3.8132245764198637`*^9}, 
   3.8132253381830854`*^9},ExpressionUUID->"0ff499ab-7446-471c-90ae-\
a2542747e979"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["w", "j"], "=", 
  RowBox[{
   UnderscriptBox["\[Sum]", "i"], 
   SubscriptBox["x", 
    StyleBox["ij",
     FontSlant->"Italic"]]}]}]], "DisplayFormula",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"93232a19-bbcf-48b7-bba8-87d8ec0c2adc"],

Cell[TextData[{
 "\t\:0412 \:0442\:0430\:043a\:043e\:043c \
\:0441\:043b\:0443\:0447\:0430\:0435 \:0437\:0430 \:043c\:0430\:043a\:0441\
\:0438\:043c\:0430\:043b\:044c\:043d\:0443\:044e \:0448\:0438\:0440\:0438\
\:043d\:0443 \:0441\:043b\:043e\:044f \:043e\:0442\:0432\:0435\:0447\:0430\
\:0435\:0442 ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "c0beb0ce-5acc-46c1-a6ac-93ce79bc0ce3"]
}], "Text",
 CellChangeTimes->{{3.8132253359919443`*^9, 
  3.813225363338558*^9}},ExpressionUUID->"c48e53c9-751a-44f6-b59f-\
47328c1e1716"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["w", "j"], "\[LessEqual]", "W"}]], "DisplayFormula",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}, {3.813225369895084*^9, 3.813225370717384*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"8f9c2008-710c-4798-97cd-675e444fba1b"],

Cell[TextData[{
 "\t\:0414\:043b\:044f \:043a\:0430\:0436\:0434\:043e\:0439 \
\:0432\:0435\:0440\:0448\:0438\:043d\:044b ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "cdf4a946-4928-44b0-a9cf-823ee13f19ea"],
 " \:043c\:044b \:043c\:043e\:0436\:0435\:043c \:043e\:043f\:0440\:0435\:0434\
\:0435\:043b\:0438\:0442\:044c \:043f\:0430\:0440\:0443 ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox[
      UnderscriptBox["h", "_"], "i"], ",", 
     SubscriptBox[
      OverscriptBox["h", "_"], "i"]}], "}"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "56d39e30-d633-42f1-8559-4c4081f64b10"],
 " \:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\:043e \:0438 \:043c\
\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\:043e\:0433\:043e \
\:043d\:043e\:043c\:0435\:0440\:0430 \:0441\:043b\:043e\:044f, \:043d\:0430 \
\:043a\:043e\:0442\:043e\:0440\:043e\:043c \:043c\:043e\:0436\:0435\:0442 \
\:043d\:0430\:0445\:043e\:0434\:0438\:0442\:044c \:0432\:0435\:0440\:0448\
\:0438\:043d\:0430. \:0421\:043e\:0437\:0434\:0430\:044e\:0442\:0441\:044f \
\:0442\:043e\:043b\:044c\:043a\:043e \:043f\:0435\:0440\:0435\:043c\:0435\
\:043d\:043d\:044b\:0435 ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", 
     StyleBox["ij",
      FontSlant->"Italic"]], ":", 
    RowBox[{
     SubscriptBox[
      UnderscriptBox["h", "_"], "i"], "\[LessEqual]", "j", "\[LessEqual]", 
     SubscriptBox[
      OverscriptBox["h", "_"], "i"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5c5b07b0-189c-48f5-b0f3-4cc654224f20"],
 ". \:041f\:043e\:0441\:043a\:043e\:043b\:044c\:043a\:0443 \:043a\:0430\:0436\
\:0434\:0430\:044f \:0432\:0435\:0440\:0448\:0438\:043d \:043b\:0435\:0436\
\:0438\:0442 \:0442\:043e\:043b\:044c\:043a\:043e \:043d\:0430 \:043e\:0434\
\:043d\:043e\:043c \:0441\:043b\:043e\:0435, \:0438\:043c\:0435\:0435\:043c"
}], "Text",
 CellChangeTimes->{{3.8132246453022966`*^9, 3.8132246779384837`*^9}, {
   3.8132247207175283`*^9, 3.813224877448941*^9}, {3.81322492957831*^9, 
   3.813224947158163*^9}, 3.813225338732616*^9, {3.813225761941059*^9, 
   3.813225802902315*^9}, {3.813225852261572*^9, 
   3.813225856143719*^9}},ExpressionUUID->"fdf59218-cfaf-4c30-bf2a-\
d3684379ec81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{
     FormBox["j",
      TraditionalForm], "=", 
     FormBox[
      SubscriptBox[
       UnderscriptBox["h", "_"], "i"],
      TraditionalForm]}], 
    FormBox[
     SubscriptBox[
      OverscriptBox["h", "_"], "i"],
     TraditionalForm]], 
   SubscriptBox["x", 
    StyleBox["ij",
     FontSlant->"Italic"]]}], "=", "1"}]], "DisplayFormula",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}, {3.813224953554*^9, 3.813225011766345*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"078f0871-dbf6-4fba-83e9-f959b9b9772f"],

Cell["\t\:0427\:0442\:043e\:0431\:044b \:0443\:0437\:043d\:0430\:0442\:044c, \
\:043d\:0430 \:043a\:0430\:043a\:043e\:043c \:0441\:043b\:043e\:0435 \:043d\
\:0430\:0445\:043e\:0434\:0438\:0442\:0441\:044f \:0432\:0435\:0440\:0448\
\:0438\:043d\:0430, \:0438\:0441\:043f\:043e\:043b\:044c\:0437\:0443\:0435\
\:043c ", "Text",
 CellChangeTimes->{{3.813225082815817*^9, 
  3.813225099219672*^9}},ExpressionUUID->"c04ecf6e-342f-4be7-9e9e-\
f94c8053db14"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["h", "i"], "=", 
  RowBox[{
   UnderoverscriptBox["\[Sum]", 
    RowBox[{
     FormBox["j",
      TraditionalForm], "=", 
     FormBox[
      SubscriptBox[
       UnderscriptBox["h", "_"], "i"],
      TraditionalForm]}], 
    FormBox[
     SubscriptBox[
      OverscriptBox["h", "_"], "i"],
     TraditionalForm]], 
   RowBox[{"j", "\[Times]", 
    SubscriptBox["x", 
     StyleBox["ij",
      FontSlant->"Italic"]]}]}]}]], "DisplayFormula",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}, {3.813224953554*^9, 3.813225011766345*^9}, {
  3.8132251138782005`*^9, 3.813225118055503*^9}, {3.8132252799442945`*^9, 
  3.8132252856464233`*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"c858f601-4ef7-4edd-8ac3-1c562b66cd44"],

Cell[TextData[{
 "\t\:0412 \:0442\:0430\:043a\:043e\:043c \
\:0441\:043b\:0443\:0447\:0430\:0435 \:0437\:0430 \:043a\:043e\:043b\:0438\
\:0447\:0435\:0441\:0442\:0432\:043e \:0441\:043b\:043e\:0451\:0432 \:043e\
\:0442\:0432\:0435\:0447\:0430\:0435\:0442 ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "6997dbf9-44a2-43d5-81d6-605e66330ded"]
}], "Text",
 CellChangeTimes->{{3.813225374993687*^9, 
  3.8132253900490713`*^9}},ExpressionUUID->"858f556d-c6d8-46ed-9cd8-\
418fa084debe"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["h", "i"], "\[LessEqual]", "H"}]], "DisplayFormula",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}, {3.813224953554*^9, 3.813225011766345*^9}, {
  3.8132251138782005`*^9, 3.813225118055503*^9}, {3.8132252799442945`*^9, 
  3.8132252856464233`*^9}, {3.8132253956822743`*^9, 3.8132253974774747`*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"6cc68b33-cba2-4540-96a9-ccaaaf4d82b3"],

Cell[TextData[{
 "\t\:041d\:0435 \:0437\:0430\:0431\:044b\:0432\:0430\:0435\:043c \
\:043f\:0440\:043e \:043f\:043e\:0440\:044f\:0434\:043e\:043a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ForAll]", 
    RowBox[{
     RowBox[{"u", "\[DirectedEdge]", "v"}], "\[Element]", "A"}]}], 
   TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "360161a1-7a20-4863-9568-9e0fa6aaca2d"]
}], "Text",
 CellChangeTimes->{{3.813226082833443*^9, 
  3.813226116303957*^9}},ExpressionUUID->"ba61fbab-dc2e-48f7-a1d5-\
a893061d7ddf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["h", "v"], "-", 
   SubscriptBox["h", "u"]}], "\[GreaterEqual]", "1"}]], "DisplayFormula",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}, {3.813224953554*^9, 3.813225011766345*^9}, {
  3.8132251138782005`*^9, 3.813225118055503*^9}, {3.8132252799442945`*^9, 
  3.8132252856464233`*^9}, {3.8132253956822743`*^9, 3.8132253974774747`*^9}, {
  3.813226093368305*^9, 3.8132261054210815`*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"90a34e49-c313-49b0-b41c-5c86d2a89075"],

Cell["\t\:041d\:0443, \:0438, \:043a\:043e\:043d\:0435\:0447\:043d\:043e, \
\:043e\:0433\:0440\:0430\:043d\:0438\:0447\:0435\:043d\:0438\:0435 \:0446\
\:0435\:043b\:043e\:0447\:0438\:0441\:043b\:0435\:043d\:043d\:043e\:0441\:0442\
\:0438", "Text",
 CellChangeTimes->{{3.813225123510345*^9, 
  3.8132251449397755`*^9}},ExpressionUUID->"15e4a303-7be8-44f0-a286-\
53365505cac1"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["x", 
   StyleBox["ij",
    FontSlant->"Italic"]], "\[Element]", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]], "DisplayFormula",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}, {3.813224953554*^9, 3.813225011766345*^9}, {
  3.8132251138782005`*^9, 3.813225118055503*^9}, {3.8132251498237476`*^9, 
  3.8132251559264193`*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"b81dcdbc-7cf4-4ecd-ac39-34b6d7efb0f2"],

Cell["\t\:0421\:043e\:0431\:0435\:0440\:0451\:043c \:0432\:0441\:0451 \:0432\
\:043c\:0435\:0441\:0442\:0435. ", "Text",
 CellChangeTimes->{{3.8132261211462727`*^9, 
  3.8132261277139935`*^9}},ExpressionUUID->"f2c9b578-cc4b-4fbb-93e4-\
bb59ebed7c0d"],

Cell[TextData[{
 "\t\:0412 \:0434\:0430\:043d\:043d\:043e\:0439 \
\:043f\:043e\:0441\:0442\:0430\:043d\:043e\:0432\:043a\:0435 \:043c\:044b \
\:043c\:043e\:0436\:0435\:043c \n1) \
\:043c\:0438\:043d\:0438\:043c\:0438\:0437\:0438\:0440\:043e\:0432\:0430\:0442\
\:044c \:043a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e \:0441\
\:043b\:043e\:0451\:0432 ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "501cecbf-e752-4939-a6c9-8385df8e31d2"],
 " \:043f\:0440\:0438 \:0444\:0438\:043a\:0441\:0438\:0440\:043e\:0432\:0430\
\:043d\:043d\:043e\:043c ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "dbdc9bd7-a905-45e9-99da-008845f5fbda"],
 "\n2) \:043c\:0438\:043d\:0438\:043c\:0438\:0437\:0438\:0440\:043e\:0432\
\:0430\:0442\:044c \:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\
\:043d\:0443\:044e \:0448\:0438\:0440\:0438\:043d\:0443 \:0441\:043b\:043e\
\:044f\t",
 Cell[BoxData[
  FormBox["W", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "9b6a54c7-3cb5-43b4-9c28-dd8b9154e2ab"],
 " \:043f\:0440\:0438 \:0444\:0438\:043a\:0441\:0438\:0440\:043e\:0432\:0430\
\:043d\:043d\:043e\:043c ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "93dc16e5-129c-41dd-9e8e-45a6e37e2635"],
 "\n3) \:043c\:0438\:043d\:0438\:043c\:0438\:0437\:0438\:0440\:043e\:0432\
\:0430\:0442\:044c \:0432\:0437\:0432\:0435\:0448\:0435\:043d\:043d\:0443\
\:044e \:0441\:0443\:043c\:043c\:0443 ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b8e5d631-3dc6-4e87-8593-5d97bd0ca742"],
 " \:0438 ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1be23dcd-80f0-4183-b8f8-b1d73db5f0c0"],
 "\n\t\:041f\:0443\:0441\:0442\:044c ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "\[Element]", 
    RowBox[{"[", 
     RowBox[{"0", ",", "1"}], "]"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "c163fcb2-8fe6-4994-b7ff-c8c18d111b08"],
 " \[Dash] \:043f\:0430\:0440\:0430\:043c\:0435\:0442\:0440, \:043e\:0442\
\:0432\:0435\:0447\:0430\:044e\:0449\:0438\:0439 \:0437\:0430 \:0437\:043d\
\:0430\:0447\:0438\:043c\:043e\:0441\:0442\:044c \
\[OpenCurlyDoubleQuote]\:0432\:044b\:0441\:043e\:0442\:044b\
\[CloseCurlyDoubleQuote] \:0438 \[OpenCurlyDoubleQuote]\:0448\:0438\:0440\
\:0438\:043d\:044b\[CloseCurlyDoubleQuote] \:0433\:0440\:0430\:0444\:0430, \
\:0430 ",
 Cell[BoxData[
  FormBox["H", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "a78b2bc9-944a-4942-9123-6a6d9756ab91"],
 " \:0438 ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "12f61cd0-1b63-481c-8d12-4c21f1cababf"],
 " \:044f\:0432\:043b\:044f\:044e\:0442\:0441\:044f \:043f\:0435\:0440\:0435\
\:043c\:0435\:043d\:043d\:044b\:043c\:0438 \:0438\:043b\:0438 \:0444\:0438\
\:043a\:0441\:0438\:0440\:043e\:0432\:0430\:043d\:043d\:044b\:043c\:0438 \
\:043f\:043e \:0436\:0435\:043b\:0430\:043d\:0438\:044e \:043f\:043e\:043b\
\:044c\:0437\:043e\:0432\:0430\:0442\:0435\:043b\:044f. \:0422\:043e\:0433\
\:0434\:0430"
}], "Text",
 CellChangeTimes->{{3.813225177516991*^9, 3.8132251810083637`*^9}, {
  3.813225242815132*^9, 3.813225328410241*^9}, {3.8132254039810877`*^9, 
  3.8132255434339976`*^9}, {3.813225579166487*^9, 
  3.813225586651599*^9}},ExpressionUUID->"c3148742-25e8-469b-b393-\
e5d03a07eecb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]", " ", "H"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
   RowBox[{"W", "\[LongRightArrow]", "min"}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}, {3.813224953554*^9, 3.813225011766345*^9}, {
  3.8132251138782005`*^9, 3.813225118055503*^9}, {3.8132252799442945`*^9, 
  3.8132252856464233`*^9}, {3.8132253956822743`*^9, 3.8132253974774747`*^9}, {
  3.813225554622059*^9, 3.8132255755671883`*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"2852a90b-1b49-4f88-bb40-9a3e31e8e5ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{
      FormBox["k",
       TraditionalForm], "=", 
      FormBox[
       SubscriptBox[
        UnderscriptBox["h", "_"], "v"],
       TraditionalForm]}], 
     FormBox[
      SubscriptBox[
       OverscriptBox["h", "_"], "v"],
      TraditionalForm]], 
    SubscriptBox["x", 
     RowBox[{"v", ",", "k"}]]}], "=", "1"}], ",", "        ", 
  RowBox[{"\[ForAll]", 
   RowBox[{"v", "\[Element]", "V"}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}, {3.813224953554*^9, 3.813225011766345*^9}, {
  3.8132251138782005`*^9, 3.813225118055503*^9}, {3.8132252799442945`*^9, 
  3.8132252856464233`*^9}, {3.8132253956822743`*^9, 3.8132253974774747`*^9}, {
  3.813225554622059*^9, 3.813225673007349*^9}, {3.8132260487204304`*^9, 
  3.8132260520824146`*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"c2833dc7-f7ff-4f6e-944f-53d99cd4d318"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{
      FormBox["k",
       TraditionalForm], "=", 
      FormBox[
       SubscriptBox[
        UnderscriptBox["h", "_"], "v"],
       TraditionalForm]}], 
     FormBox[
      SubscriptBox[
       OverscriptBox["h", "_"], "v"],
      TraditionalForm]], 
    RowBox[{"k", " ", 
     SubscriptBox["x", 
      RowBox[{"v", ",", "k"}]]}]}], "\[LessEqual]", "H"}], ",", "        ", 
  RowBox[{"\[ForAll]", 
   RowBox[{"v", "\[Element]", "V"}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}, {3.813224953554*^9, 3.813225011766345*^9}, {
  3.8132251138782005`*^9, 3.813225118055503*^9}, {3.8132252799442945`*^9, 
  3.8132252856464233`*^9}, {3.8132253956822743`*^9, 3.8132253974774747`*^9}, {
  3.813225554622059*^9, 3.813225673007349*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"605baa8d-ad23-4522-aa29-b7921ec4e132"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    UnderscriptBox["\[Sum]", 
     RowBox[{"v", "\[Element]", "V"}]], 
    SubscriptBox["x", 
     StyleBox[
      RowBox[{"v", ",", "k"}],
      FontSlant->"Italic"]]}], "\[LessEqual]", "W"}], ",", "        ", 
  RowBox[{"\[ForAll]", 
   RowBox[{"1", "\[LessEqual]", "k", "\[LessEqual]", 
    SubscriptBox["h", "max"]}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
   3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
   3.8065427992419662`*^9}, {3.8065798537661047`*^9, 
   3.8065798628379064`*^9}, {3.808632926727707*^9, 3.808632931119953*^9}, {
   3.8086354545791883`*^9, 3.8086354566817055`*^9}, {3.808639152280423*^9, 
   3.8086391818856754`*^9}, {3.8100891585450115`*^9, 
   3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
   3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
   3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
   3.8132246141830797`*^9}, {3.813224953554*^9, 3.813225011766345*^9}, {
   3.8132251138782005`*^9, 3.813225118055503*^9}, {3.8132252799442945`*^9, 
   3.8132252856464233`*^9}, {3.8132253956822743`*^9, 
   3.8132253974774747`*^9}, {3.813225554622059*^9, 3.8132255755671883`*^9}, 
   3.8132256059099727`*^9, {3.8132256852854986`*^9, 3.8132256887791433`*^9}, {
   3.813225721153448*^9, 3.813225756569408*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"cc8186ee-9c49-4eef-8a15-8c2d026a8e1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{
       FormBox["k",
        TraditionalForm], "=", 
       FormBox[
        SubscriptBox[
         UnderscriptBox["h", "_"], "v"],
        TraditionalForm]}], 
      FormBox[
       SubscriptBox[
        OverscriptBox["h", "_"], "v"],
       TraditionalForm]], 
     RowBox[{"k", " ", 
      SubscriptBox["x", 
       RowBox[{"v", ",", "k"}]]}]}], "-", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{
       FormBox["k",
        TraditionalForm], "=", 
       FormBox[
        SubscriptBox[
         UnderscriptBox["h", "_"], "v"],
        TraditionalForm]}], 
      FormBox[
       SubscriptBox[
        OverscriptBox["h", "_"], "v"],
       TraditionalForm]], 
     RowBox[{"k", " ", 
      SubscriptBox["x", 
       RowBox[{"u", ",", "k"}]]}]}]}], "\[GreaterEqual]", "1"}], ",", 
  "        ", 
  RowBox[{"\[ForAll]", 
   RowBox[{
    RowBox[{"u", "\[DirectedEdge]", "v"}], "\[Element]", 
    "A"}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}, {3.813224953554*^9, 3.813225011766345*^9}, {
  3.8132251138782005`*^9, 3.813225118055503*^9}, {3.8132252799442945`*^9, 
  3.8132252856464233`*^9}, {3.8132253956822743`*^9, 3.8132253974774747`*^9}, {
  3.813225554622059*^9, 3.813225673007349*^9}, {3.8132258964579988`*^9, 
  3.8132259216675043`*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"152aef4a-f9c9-4f41-9df9-8ce1fd399cb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["x", 
    StyleBox[
     RowBox[{"v", ",", "k"}],
     FontSlant->"Italic"]], "\[Element]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ",", "         ", 
  RowBox[{"\[ForAll]", 
   RowBox[{"v", "\[Element]", 
    RowBox[{"V", 
     RowBox[{"\[ForAll]", 
      RowBox[{"1", "\[LessEqual]", "k", "\[LessEqual]", 
       SubscriptBox["h", "max"]}]}]}]}]}]}]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.805081937648107*^9, 3.8050819565257936`*^9}, {
  3.805704392197638*^9, 3.805704393030958*^9}, {3.8065427929437866`*^9, 
  3.8065427992419662`*^9}, {3.8065798537661047`*^9, 3.8065798628379064`*^9}, {
  3.808632926727707*^9, 3.808632931119953*^9}, {3.8086354545791883`*^9, 
  3.8086354566817055`*^9}, {3.808639152280423*^9, 3.8086391818856754`*^9}, {
  3.8100891585450115`*^9, 3.8100892297226963`*^9}, {3.8100892802605343`*^9, 
  3.8100892985892816`*^9}, {3.812120925121935*^9, 3.812120951737821*^9}, {
  3.813122069111512*^9, 3.813122145614876*^9}, {3.8132244839858847`*^9, 
  3.8132246141830797`*^9}, {3.813224953554*^9, 3.813225011766345*^9}, {
  3.8132251138782005`*^9, 3.813225118055503*^9}, {3.8132252799442945`*^9, 
  3.8132252856464233`*^9}, {3.8132253956822743`*^9, 3.8132253974774747`*^9}, {
  3.813225554622059*^9, 3.813225673007349*^9}, {3.8132258964579988`*^9, 
  3.8132259858359365`*^9}},
 SingleLetterItalics->
  True,ExpressionUUID->"6fad4ca2-1093-487e-811a-b74d02ba3fd5"],

Cell[TextData[{
 "\:0433\:0434\:0435 ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["h", "max"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5d1ad90e-8fa9-4cfc-bdb8-adf792c3e852"],
 " \[Dash] \:043f\:0430\:0440\:0430\:043c\:0435\:0442\:0440, \:043e\:043f\
\:0440\:0435\:0434\:0435\:043b\:044f\:0435\:043c\:044b\:0439 \:043f\:043e\
\:043b\:044c\:0437\:043e\:0432\:0430\:0442\:0435\:043b\:0435\:043c \[Dash] \
\:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\:043e \:0434\
\:043e\:043f\:0443\:0441\:0442\:0438\:043c\:043e\:0435 \:0447\:0438\:0441\
\:043b\:043e \:0441\:043b\:043e\:0451\:0432 (\:0434\:043b\:044f \:043a\:043e\
\:0442\:043e\:0440\:044b\:0445 \:0432\:043e\:043e\:0431\:0449\:0435 \:0431\
\:0443\:0434\:0443\:0442 \:0441\:043e\:0437\:0434\:0430\:0432\:0430\:0442\
\:044c\:0441\:044f \:043f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\
\:0435). "
}], "Text",
 CellChangeTimes->{{3.813225989853692*^9, 3.8132260287128954`*^9}, {
  3.8132260594994173`*^9, 3.813226066612459*^9}, {3.813226135622551*^9, 
  3.8132261440640345`*^9}},ExpressionUUID->"07c1a853-73bf-46d5-bf30-\
a81dc11eef7e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SeedRandom", "[", "52", "]"}], "\[IndentingNewLine]", 
 RowBox[{"graph", "=", 
  RowBox[{"RandomGraph", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"10", ",", "14"}], "}"}], ",", 
    RowBox[{"DirectedEdges", "\[Rule]", "True"}], ",", 
    RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.812194722703136*^9, 3.812194808370104*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0ebf9567-91e6-442c-93d0-3a70e1995bda"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}, {
       SparseArray[
       Automatic, {10, 10}, 0, {
        1, {{0, 1, 1, 3, 5, 7, 9, 10, 13, 13, 14}, {{9}, {4}, {10}, {9}, {
          10}, {2}, {10}, {3}, {5}, {1}, {3}, {7}, {9}, {7}}}, Pattern}], 
       Null}, {VertexLabels -> {"Name"}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
        ArrowBox[{{0., 1.}, {1., 0.}}, 0.04847715736040609], 
        ArrowBox[{{1., 5.}, {1., 4.}}, 0.04847715736040609], 
        ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQDQEf7CG0iINa/5ozV4vf2T+ZOHVn1TlhB5msrq0t
y9/YO/tunPZhirDD4wkzd/HMfmUvaxQ8PTFY2KGM+dbtXL8X9vkO1bvPcgo7
3D7oLbni4FN76wpNZtMdQg58Z94V7f7yyL7pZmze9DghByWXtov+5+/bO6VI
/P3yR9DhRPvEr7dMbtrXSESu950s6MCV/D9QQuqSvcE3+daFioIOCzatXMU8
+4z9DKXOySfvCzgcebPy3LpnR+0rFrv4/54l4FBT8p/fSPyA/ZmKoB1mwQIO
/ZND7kpFbrOfumjTuWoOAaj+NfYrHE+pTC3lh6pfYC/w/DKb2xU+qHyPfYpp
kzOXLp/DSjA/x36JztVbD+t5HWAhdPYMCPDA+elvHn09L43g/0qcaPShhBvO
b9G90aR7gwvOZ/Hf/qzdFcGvPqYX938PJ5z/arLdy8l2CD5Y+SkOOH+NgbqV
SAKCDwEcDgDiqKLy
         "]], 0.04847715736040609], ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGDQA2IQDQEf7CG0gAOMH3z+xtHX8/nh/I0ekhW7TPkdGKF8
iZyDYjkH+eDyrZYXFzI4I/h/NoA08ML5dZfUay+pI/hs8/LO8nfzwPkzhGW5
DJ5ww/nGYIDgXwRpr+WC84tkjhfKHOeEu0dYEAQ44fIbWKOBiAPOD/i1xP/X
EnY4//07EGCD8/seWwARgq93o0n3RhMrnG8Cdg8znH8F7B4mOL8Q7B5GuHuE
wO5hRIQf2D0McP6CL57zv3j+t4fx790Fgb9wvizIuMI/cH4M2EO/4fw0MPgG
5y/2B3nwC5wP9k7fZ3uYe5SVQOATXD6Re1sC97YPcL79y8l2Lye/g/P37AaB
13C+JTiAXsD5IN0J3M/gfEh8PYbz523svm6f/wDOP8ffPaVx+W24e8TB6eca
XB6Uuux1LsH5K9LfPPp6/jScP8UO5MDDcP6Dl9eASWwnnP9P60wnH+sKOJ8B
CgCbJdOq
         "]], 0.04847715736040609], 
        ArrowBox[{{1., 4.}, {0., 3.}}, 0.04847715736040609], 
        ArrowBox[{{-1., 5.}, {-2., 4.}}, 0.04847715736040609], 
        ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGCQAWIQDQEf9kNoEQcYf2X6m0dfzwvD+RFLeGzuzhJ2YITy
ebYlcG9LQMgfnvMioEERwa8DaxCC8+1fTrZ7ORnBZ/Hf/qzdFcE/08nHKvFJ
EM6fNRMEBB18w0L/pDx+v3995lQhfgdBB7PI0I+Te9/v93tqd6/qpYDDLg6G
+z3/3u2v5Jn2585UAYdrKaFH/c3e7de5PyvX1FXAoS83dMkdk7f7r+2alcTx
nt/hkRJDjfGv1/uz+KL7J0XyO5xvCfUJaXu1X2BnWSLnKT6HiMmhovY3X+w/
t+vtjRwHPodqP4brnz892z9f+MDXPXt4HWRszFsnpT7ez3bed2HKTR6H93dt
xCMkHuyvMT/PKsbG4/AsXUmqU+zW/n8+LsoXnbgdfGoyzq6vubK/i3/tz6n9
XA7qn6ZP8Dh2br9yPWdnyhtOh+o9M0XPTj66/8TsyIs2kZwOcuvXBN86vGt/
ZercS3LXOBzm8ZqbLj60Yr/5nSs9XMkcDgwogMMBAIpjtc8=
         "]], 0.04847715736040609], 
        ArrowBox[{{1., 6.}, {1., 5.}}, 0.04847715736040609], 
        ArrowBox[{{1., 6.}, {-1., 5.}}, 0.04847715736040609], 
        ArrowBox[{{0., 2.}, {0., 1.}}, 0.04847715736040609], 
        ArrowBox[{{2., 6.}, {1., 5.}}, 0.04847715736040609], 
        ArrowBox[BezierCurveBox[CompressedData["
1:eJxTTMoPSmViYGDQA2IQDQUOEErCAcZfmf7m0dfz4nB+5BIem7uzxB0YoXye
bQnc2xIQ8ofnvAhoUETw6yNAGsTgfPuXk+1eTkbwWfy3P2t3RfDPdvKxSnwS
hfNnzQQBBB+s3Q7Bt+x7bNH3WATuns4OEBCBy99s0r3RpIvga9ReUq+9JAzn
V5SDAIJ/vFAGiBB88ZyDYjkHhdDcIwjnvwK7B8GHuEcA7p4usHsE4PI3wO5B
8AN+LfH/tYQfzv/wDgT44HywcRYIvh7YAF443xgMuB3Eih+1vHj7375Pyo99
fxOXQ9SZTuFF2//bpz7ncq28y+lwivvbap3Y//bbZma+SXTmdEgxVPfruPfP
vsYw62/FFg4HHVvZX1us/9nvW8dTsc+Aw0FB/8b6TSV/7SsFA2OMdrA7OLJH
5Dd2/rFfE2m+6ooXu0Pf0TkWilW/7WPa9ycufcHmwJG1jHuS2y/7plkvm5ZM
ZHMIyqtbUcL2zX7qbHmtuY2sDokJ9lat0p/sJW/0+z1sY3FIabjU2M791p43
wOpDwUJmhzbpHxUJXc/si5jl+X0uMjnoT3ofOXXzA3u3T7ari8SYHHadKPT0
4btu3yMz/ciTAkYHS4+AVG+RM/ZOTVrRix4wOGjf4th3O2unfabyj7zVqbB0
DAcOAIYc3ig=
         "]], 0.04847715736040609], ArrowBox[BezierCurveBox[CompressedData["
1:eJxdkGtIk1EYx985371b4nWbs8sq84OIqJV3kc6DzUjKjNmK0QW1TcxCWfTB
0lkJsxxq5dxMS2sZYaGlFqTLcmWhBmleEq3sZgXddPOeU8u9riP05xwefvzh
4XeOZ1K6WG5HEAQsXOu0BRaHB4S87c1fdpCAzxe0jSc6BHBcXt69uo8AUWyd
zlQsgPZL0q5IKQOEG+NLEuMF4HWSkyf7yYB0yHzwgiOAPOea39pzdhCZ4cMM
bnCHue0ir64oJuQM7E8rOeAOWaGdpDvLHjbLPObGZ/lAdcbqZQP2oPSQ3onV
8KGCa5xoaiJhw+Qald6TD69kkmdxISwoXZenaX/Pg6BEPlerZ0FGpSjOUsaD
RjbxPn+eBS8yxA0h8Tw4uJfvExpLge5afUcmmwchUolZU0BB71p50XMDF/zt
jKGVzRScHTvE9Erlwo7dklnZEAX1Kx57qty5UCzho4FpCsS61F+mZjfbv7Ch
rNQaV/hDh4Lvmk3fNJtccR9eOBRWOOQCDBurz1rjgvv+HL+Fs8Q7Z67HzVx3
xmwatsYJM70ubIn96QWOmAPpOGCfLm9lt7dyGe6PrmpVrGrlYB+uqzUc3NeS
excO+z8fCvMI7cP6z2eJF31IzEG0DxP79NI+drhX0D4M7ONG+zBwX0f7EJiv
jsdcGY/5g/7xu0Fr5jALresUs5j30Q+yYE6mM4nU4Yqo8UkKhMGXnbLJCeT3
9Smn6w0FbR189ahhDH0hLRLdbQpSAnv6W3JHUf1FrrconYKppN4Zc4oZ6Sqc
lK+FFGTuX27KSjSh84Kfe6QGFnyMFinaPwwjPbP6vlHEgnvJg1Vi31+oNWnH
ZZeHJBwWzudqr/1A9sE9ZIwXCezUGw5FW74jn1C0K4LJBHFadtUx1le0vnZN
+RNHBiQmoAjVyk8oEL4ZW1TzSHaq+/QZh0HU4pgVuT7agnJXTmckqPuQoH2q
+rl0GgUUjUi1d1+igKP73DQtE8jQpojZ7tSKKM6tI3k5Yyh86075Nl4Tqiz4
8KBGZ0a+r9mP3qTetP2PyTYJ4i+fR2ag
         "]], 0.04847715736040609], 
        ArrowBox[{{0., 3.}, {0., 2.}}, 0.04847715736040609]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 1.}, 0.04847715736040609], 
         InsetBox["1", 
          Offset[{2, 2}, {0.04847715736040609, 1.0484771573604061}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-2., 4.}, 0.04847715736040609], 
         InsetBox["2", 
          Offset[{2, 2}, {-1.9515228426395939, 4.048477157360406}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 5.}, 0.04847715736040609], 
         InsetBox["3", 
          Offset[{2, 2}, {1.0484771573604061, 5.048477157360406}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 4.}, 0.04847715736040609], 
         InsetBox["4", 
          Offset[{2, 2}, {1.0484771573604061, 4.048477157360406}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 5.}, 0.04847715736040609], 
         InsetBox["5", 
          Offset[{2, 2}, {-0.9515228426395939, 5.048477157360406}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 6.}, 0.04847715736040609], 
         InsetBox["6", 
          Offset[{2, 2}, {1.0484771573604061, 6.048477157360406}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 2.}, 0.04847715736040609], 
         InsetBox["7", 
          Offset[{2, 2}, {0.04847715736040609, 2.048477157360406}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{2., 6.}, 0.04847715736040609], 
         InsetBox["8", Offset[{2, 2}, {2.048477157360406, 6.048477157360406}],
           ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{1., 0.}, 0.04847715736040609], 
         InsetBox["9", 
          Offset[{2, 2}, {1.0484771573604061, 0.04847715736040609}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 3.}, 0.04847715736040609], 
         InsetBox["10", 
          Offset[{2, 2}, {0.04847715736040609, 3.048477157360406}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{3.813285400139451*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"6c8ad215-23b1-4ef5-9ed5-6061ceddbf41"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "LongestPathLength", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LongestPathLength", "::", "\"\<usage\>\""}], "=", 
   "\"\<\:0418\:0449\:0435\:0442 \:0434\:043b\:0438\:043d\:0443 \:0434\:043b\
\:0438\:043d\:043d\:0435\:0439\:0448\:0435\:0433\:043e \:043f\:0443\:0442\
\:0438 \:0432 \:0433\:0440\:0430\:0444\:0435\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LongestPathLength", "[", 
   RowBox[{"graph_", "/;", 
    RowBox[{
     RowBox[{"VertexCount", "[", "graph", "]"}], "\[Equal]", "1"}]}], "]"}], ":=",
   "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LongestPathLength", "[", "graph_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"inc", "=", 
      RowBox[{"Transpose", "@", 
       RowBox[{"IncidenceMatrix", "@", "graph"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Max", "@", 
     RowBox[{"LinearProgramming", "[", 
      RowBox[{
       RowBox[{"Total", "@", "inc"}], ",", "inc", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", 
         RowBox[{"EdgeCount", "@", "graph"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.812194892836174*^9, 3.8121948950272417`*^9}, {
  3.812195146423419*^9, 3.81219516151411*^9}, {3.8121951974620028`*^9, 
  3.8121952748118005`*^9}, {3.8121953297369204`*^9, 3.8121954090416107`*^9}, {
  3.8121954629397297`*^9, 3.8121955231118946`*^9}, {3.812195577097498*^9, 
  3.8121956463174706`*^9}, {3.812195688480729*^9, 3.8121957814712133`*^9}, {
  3.812196709889487*^9, 3.8121967184351273`*^9}, {3.81328552039028*^9, 
  3.813285641937273*^9}, {3.813285686278119*^9, 3.81328569543832*^9}, {
  3.81328605461722*^9, 3.8132860811176157`*^9}, {3.8132863839991417`*^9, 
  3.8132863842250195`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"c7ee2d0f-3d70-4860-b554-f6f9e41ba65c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "strangeGetLayers", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "strangeGetLayers", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MaxLayer", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MaxWidth", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MaxHeight", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Intervals", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Alpha", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strangeGetLayers", "[", 
   RowBox[{"graph_", ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "flat", ",", "vars", ",", "vertices", ",", "res", ",", "gr", ",", 
      "\[IndentingNewLine]", "hMax", ",", "hLow", ",", "hHigh", ",", 
      "\[IndentingNewLine]", "x", ",", "H", ",", "W", ",", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"OptionValue", "[", "Alpha", "]"}]}], ",", 
      "\[IndentingNewLine]", "r2", ",", "r3", ",", "r4", ",", "r5", ",", "r6",
       ",", "tmp"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vertices", "=", 
      RowBox[{"VertexList", "@", "graph"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"hMax", "=", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "MaxLayer", "]"}], "===", "Automatic"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"LongestPathLength", "@", "graph"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"OptionValue", "[", "MaxLayer", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "Intervals", "]"}], "===", "Automatic"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"hLow", "=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"LongestPathLength", "@", 
             RowBox[{"Subgraph", "[", 
              RowBox[{"graph", ",", 
               RowBox[{"VertexInComponent", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"{", "vertex", "}"}]}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"vertex", ",", "vertices"}], "}"}]}], "]"}], "+", 
          "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hHigh", "=", 
         RowBox[{"hMax", "-", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"LongestPathLength", "@", 
             RowBox[{"Subgraph", "[", 
              RowBox[{"graph", ",", 
               RowBox[{"VertexOutComponent", "[", 
                RowBox[{"graph", ",", 
                 RowBox[{"{", "vertex", "}"}]}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"vertex", ",", "vertices"}], "}"}]}], "]"}], "+", 
          "1"}]}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"hLow", ",", "hHigh"}], "}"}], "=", 
        RowBox[{"Transpose", "@", 
         RowBox[{"OptionValue", "[", "Intervals", "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "MaxWidth", "]"}], "=!=", "Automatic"}], 
       ",", 
       RowBox[{"W", "=", 
        RowBox[{"OptionValue", "[", "MaxWidth", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "MaxHeight", "]"}], "=!=", "Automatic"}], 
       ",", 
       RowBox[{"H", "=", 
        RowBox[{"OptionValue", "[", "MaxHeight", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"x", "[", 
           RowBox[{"#", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"#2", ",", "#3"}], "]"}]}], "]"}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"vertices", ",", "hLow", ",", "hHigh"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"flat", "=", 
      RowBox[{"Flatten", "@", "vars"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Dot", ",", 
        RowBox[{"{", 
         RowBox[{"vars", ",", 
          RowBox[{"vars", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}],
          "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"\:0441\:0443\:043c\:043c\:0430", " ", "\:0438\:0437", " ", 
       RowBox[{"(", "3", ")"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r2", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"vars", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r3", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"tmp", "\[LessEqual]", "H"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r4", "=", 
      RowBox[{"Values", "@", 
       RowBox[{"GroupBy", "[", 
        RowBox[{"flat", ",", "Last", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", "#", "]"}], "\[LessEqual]", "W"}], "&"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r5", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"tmp", "\[LeftDoubleBracket]", 
           RowBox[{
           "arc", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"tmp", "\[LeftDoubleBracket]", 
           RowBox[{
           "arc", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[RightDoubleBracket]"}]}], "\[GreaterEqual]", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"arc", ",", 
          RowBox[{"EdgeList", "@", "graph"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r6", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{"0", "\[LessEqual]", "flat"}], "]"}], ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"flat", "\[LessEqual]", "1"}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Element", "[", 
           RowBox[{"v", ",", 
            TemplateBox[{},
             "Integers"]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"v", ",", "flat"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "MaxWidth", "]"}], "===", "Automatic"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "MaxHeight", "]"}], "===", 
           "Automatic"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Quiet", "@", 
           RowBox[{"LinearOptimization", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Alpha]", " ", "H"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Alpha]"}], ")"}], "W"}]}], ",", 
             RowBox[{"Join", "[", 
              RowBox[{"r2", ",", "r3", ",", "r4", ",", "r5", ",", "r6"}], 
              "]"}], ",", 
             RowBox[{"Join", "[", 
              RowBox[{"flat", ",", 
               RowBox[{"{", 
                RowBox[{"H", ",", "W"}], "}"}]}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Quiet", "@", 
           RowBox[{"LinearOptimization", "[", 
            RowBox[{"W", ",", 
             RowBox[{"Join", "[", 
              RowBox[{"r2", ",", "r3", ",", "r4", ",", "r5", ",", "r6"}], 
              "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"flat", ",", "W"}], "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Quiet", "@", 
         RowBox[{"LinearOptimization", "[", 
          RowBox[{"H", ",", 
           RowBox[{"Join", "[", 
            RowBox[{"r2", ",", "r3", ",", "r4", ",", "r5", ",", "r6"}], "]"}],
            ",", 
           RowBox[{"Append", "[", 
            RowBox[{"flat", ",", "H"}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gr", "=", 
      RowBox[{"GroupBy", "[", 
       RowBox[{
        RowBox[{"Pick", "[", 
         RowBox[{
          RowBox[{"Keys", "@", "res"}], ",", 
          RowBox[{"Values", "@", "res"}], ",", "1"}], "]"}], ",", 
        RowBox[{"Last", "\[Rule]", "First"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gr", "/@", 
      RowBox[{"Sort", "@", 
       RowBox[{"Keys", "@", "gr"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.81328827004943*^9, 3.813288910626459*^9}, {
  3.8132889492590523`*^9, 3.8132890899106417`*^9}, {3.813289237314098*^9, 
  3.8132892465690937`*^9}, {3.813289285572507*^9, 3.8132892875136585`*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"be767fda-9b37-448b-9e20-96d9c87f7ef2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"strangeGetLayers", "[", "graph", "]"}]], "Input",
 CellChangeTimes->{{3.813289106239611*^9, 3.8132891220111675`*^9}, 
   3.813289293150941*^9},
 CellLabel->
  "In[221]:=",ExpressionUUID->"2acb3ccc-1d48-4a0d-825c-dba5d8cae162"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"6", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", "10", "}"}], ",", 
   RowBox[{"{", "7", "}"}], ",", 
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "9", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.813289108312089*^9, 3.813289122665209*^9}, 
   3.8132892934559574`*^9},
 CellLabel->
  "Out[221]=",ExpressionUUID->"47cfc229-9981-421e-9bdd-bbbbda9234c7"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Title"], FontFamily -> "Source Sans Pro", FontSize -> 45, 
    FontWeight -> "Plain", FontSlant -> "Plain", 
    FontVariations -> {"StrikeThrough" -> False, "Underline" -> False}], 
   Cell[
    StyleData["Subtitle"]], 
   Cell[
    StyleData["Chapter"], FontFamily -> "Cambria", FontSize -> 34, FontWeight -> 
    "Bold", FontSlant -> "Plain", 
    FontVariations -> {"StrikeThrough" -> False, "Underline" -> False}, 
    FontColor -> RGBColor[0.5019607843137255, 0., 0.]], 
   Cell[
    StyleData["Section"], ShowGroupOpener -> "OutsideFrame", FontFamily -> 
    "Cambria", FontSize -> 28, FontWeight -> "Plain", FontSlant -> "Plain", 
    FontVariations -> {"StrikeThrough" -> False, "Underline" -> False}, 
    FontColor -> RGBColor[0., 0., 0.5019607843137255]], 
   Cell[
    StyleData["Subsection"], ShowGroupOpener -> "OutsideFrame", FontFamily -> 
    "Source Sans Pro", FontSize -> 20, FontWeight -> "Plain", FontSlant -> 
    "Plain", FontVariations -> {
     "StrikeThrough" -> False, "Underline" -> False}, FontColor -> 
    RGBColor[0., 0.25098039215686274`, 0.5019607843137255]], 
   Cell[
    StyleData["Subsubsection"], ShowGroupOpener -> "OutsideFrame", FontFamily -> 
    "Source Sans Pro", FontSize -> 19, FontWeight -> "Plain", FontSlant -> 
    "Plain", FontVariations -> {
     "StrikeThrough" -> False, "Underline" -> False}], 
   Cell[
    StyleData["Text"], ShowCellBracket -> False, TextJustification -> 1., 
    FontFamily -> "Times New Roman", FontSize -> 18, FontWeight -> "Plain", 
    FontSlant -> "Plain", 
    FontVariations -> {"StrikeThrough" -> False, "Underline" -> False}], 
   Cell[
    StyleData["Code"], PageWidth :> WindowWidth, CellFrame -> True, 
    CellBracketOptions -> {"Widths" -> {0, 7}}, FormatType -> InputForm, 
    AutoSpacing -> True, LineBreakWithin -> Automatic, LineIndent -> 1, 
    LinebreakAdjustments -> {0.85, 2, 10, 0, 1}, FontFamily -> 
    "Times New Roman", FontSize -> 13, FontWeight -> "Bold", FontSlant -> 
    "Plain", FontVariations -> {
     "StrikeThrough" -> False, "Underline" -> False}], 
   Cell[
    StyleData["Input"], ShowCellBracket -> True, Background -> None], 
   Cell[
    StyleData["Output"], ShowCellBracket -> True], 
   Cell[
    StyleData["DisplayFormula"], ShowCellBracket -> True, TextAlignment -> 
    Center, StyleHints -> {
     "CodeFont" -> "Cambria", "GroupOpener" -> "Inline"}, FontFamily -> 
    "Cambria", FontSize -> 18, FontWeight -> "Plain", FontSlant -> "Plain", 
    FontVariations -> {"StrikeThrough" -> False, "Underline" -> False}, 
    FontColor -> RGBColor[0., 0., 0.]], 
   Cell[
    StyleData["DisplayFormulaNumbered"], ShowCellBracket -> True, 
    TextAlignment -> Center, 
    StyleHints -> {"CodeFont" -> "Cambria", "GroupOpener" -> "Inline"}, 
    FontFamily -> "Cambria", FontSize -> 18, FontWeight -> "Plain", FontSlant -> 
    "Plain", FontVariations -> {
     "StrikeThrough" -> False, "Underline" -> False}, FontColor -> 
    RGBColor[0., 0., 0.]]}, Visible -> False, FrontEndVersion -> 
  "12.1 for Microsoft Windows (64-bit) (June 19, 2020)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"b22ceea5-57ff-4339-919a-1d6648bc3ec6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 310, 5, 64, "Section",ExpressionUUID->"8b90b408-fd12-4cee-b966-2854310cf496"],
Cell[893, 29, 1152, 26, 38, "Text",ExpressionUUID->"cd235cef-f9c5-4db4-b661-ae6e75934ae7"],
Cell[2048, 57, 2564, 63, 51, "DisplayFormula",ExpressionUUID->"56703937-6d11-41ec-bd8e-58c8a3e5797a"],
Cell[4615, 122, 400, 6, 35, "Text",ExpressionUUID->"0ff499ab-7446-471c-90ae-a2542747e979"],
Cell[5018, 130, 903, 18, 53, "DisplayFormula",ExpressionUUID->"93232a19-bbcf-48b7-bba8-87d8ec0c2adc"],
Cell[5924, 150, 582, 13, 35, "Text",ExpressionUUID->"c48e53c9-751a-44f6-b59f-47328c1e1716"],
Cell[6509, 165, 847, 13, 32, "DisplayFormula",ExpressionUUID->"8f9c2008-710c-4798-97cd-675e444fba1b"],
Cell[7359, 180, 2326, 50, 61, "Text",ExpressionUUID->"fdf59218-cfaf-4c30-bf2a-d3684379ec81"],
Cell[9688, 232, 1177, 28, 77, "DisplayFormula",ExpressionUUID->"078f0871-dbf6-4fba-83e9-f959b9b9772f"],
Cell[10868, 262, 450, 7, 35, "Text",ExpressionUUID->"c04ecf6e-342f-4be7-9e9e-f94c8053db14"],
Cell[11321, 271, 1337, 32, 77, "DisplayFormula",ExpressionUUID->"c858f601-4ef7-4edd-8ac3-1c562b66cd44"],
Cell[12661, 305, 537, 12, 35, "Text",ExpressionUUID->"858f556d-c6d8-46ed-9cd8-418fa084debe"],
Cell[13201, 319, 998, 15, 29, "DisplayFormula",ExpressionUUID->"6cc68b33-cba2-4540-96a9-ccaaaf4d82b3"],
Cell[14202, 336, 531, 14, 35, "Text",ExpressionUUID->"ba61fbab-dc2e-48f7-a1d5-a893061d7ddf"],
Cell[14736, 352, 1099, 18, 29, "DisplayFormula",ExpressionUUID->"90a34e49-c313-49b0-b41c-5c86d2a89075"],
Cell[15838, 372, 375, 6, 35, "Text",ExpressionUUID->"15e4a303-7be8-44f0-a286-53365505cac1"],
Cell[16216, 380, 1033, 19, 32, "DisplayFormula",ExpressionUUID->"b81dcdbc-7cf4-4ecd-ac39-34b6d7efb0f2"],
Cell[17252, 401, 250, 4, 35, "Text",ExpressionUUID->"f2c9b578-cc4b-4fbb-93e4-bb59ebed7c0d"],
Cell[17505, 407, 3537, 78, 127, "Text",ExpressionUUID->"c3148742-25e8-469b-b393-e5d03a07eecb"],
Cell[21045, 487, 1170, 20, 29, "DisplayFormulaNumbered",ExpressionUUID->"2852a90b-1b49-4f88-bb40-9a3e31e8e5ca"],
Cell[22218, 509, 1533, 34, 77, "DisplayFormulaNumbered",ExpressionUUID->"c2833dc7-f7ff-4f6e-944f-53d99cd4d318"],
Cell[23754, 545, 1518, 34, 77, "DisplayFormulaNumbered",ExpressionUUID->"605baa8d-ad23-4522-aa29-b7921ec4e132"],
Cell[25275, 581, 1500, 29, 54, "DisplayFormulaNumbered",ExpressionUUID->"cc8186ee-9c49-4eef-8a15-8c2d026a8e1a"],
Cell[26778, 612, 2068, 55, 77, "DisplayFormulaNumbered",ExpressionUUID->"152aef4a-f9c9-4f41-9df9-8ce1fd399cb0"],
Cell[28849, 669, 1455, 29, 29, "DisplayFormulaNumbered",ExpressionUUID->"6fad4ca2-1093-487e-811a-b74d02ba3fd5"],
Cell[30307, 700, 1136, 21, 35, "Text",ExpressionUUID->"07c1a853-73bf-46d5-bf30-a81dc11eef7e"],
Cell[CellGroupData[{
Cell[31468, 725, 488, 10, 48, "Input",ExpressionUUID->"0ebf9567-91e6-442c-93d0-3a70e1995bda"],
Cell[31959, 737, 7223, 134, 449, "Output",ExpressionUUID->"6c8ad215-23b1-4ef5-9ed5-6061ceddbf41"]
}, Open  ]],
Cell[39197, 874, 1886, 41, 105, "Input",ExpressionUUID->"c7ee2d0f-3d70-4860-b554-f6f9e41ba65c"],
Cell[41086, 917, 9919, 247, 1131, "Input",ExpressionUUID->"be767fda-9b37-448b-9e20-96d9c87f7ef2"],
Cell[CellGroupData[{
Cell[51030, 1168, 250, 5, 28, "Input",ExpressionUUID->"2acb3ccc-1d48-4a0d-825c-dba5d8cae162"],
Cell[51283, 1175, 544, 16, 32, "Output",ExpressionUUID->"47cfc229-9981-421e-9bdd-bbbbda9234c7"]
}, Open  ]]
}, Open  ]]
}
]
*)

